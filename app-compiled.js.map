{"version":3,"sources":["app.js"],"names":[],"mappings":";;AAAA,IAAI,IAAI,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;AACjC,IAAI,SAAS,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC,SAAS,CAAC;AAC/C,IAAI,WAAW,GAAG,EAAE,CAAC;AACrB,IAAI,OAAO,CAAC;AACZ,IAAI,GAAG,GAAG,CAAC,CAAC;AACZ,IAAI,eAAe,GAAG,KAAK,CAAC;;AAE5B,IAAI,QAAQ,GAAG,SAAX,QAAQ,CAAY,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE;AAChD,QAAI,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AAC9B,QAAI,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AAC9B,QAAI,OAAO,GAAG,CAAC,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAA,GAAI,EAAE,CAAC;AAC/C,WAAO,OAAO,GAAG,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;CAClD,CAAC;;AAEF,IAAI,MAAM,GAAG,SAAT,MAAM,CAAY,IAAI,EAAE;AACxB,WAAO,IAAI,KAAK,MAAM,IAAI,IAAI,KAAK,MAAM,CAAC;CAC7C,CAAC;;AAEF,IAAI,aAAa,GAAG,SAAhB,aAAa,CAAY,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE;AAClD,WAAO,KAAK,CAAC,GAAG,CAAC,UAAS,GAAG,EAAC;AAC1B,eAAO,IAAI,IAAI,CAAC,KAAK,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;KAC/D,CAAC,CAAC;CACN,CAAC;;AAEF,IAAI,WAAW,GAAG,SAAd,WAAW,CAAY,SAAS,EAAE;AAClC,aAAS,GAAG,SAAS,CAAC,OAAO,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC;AAChD,QAAI,cAAc,GAAG,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;AACxD,QAAI,cAAc,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;AAC7C,iBAAS,GAAG,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;AACrC,iBAAS,GAAG,aAAa,CAAC,IAAI,EAAE,CAAC,EAAE,OAAO,CAAC,GAAG,EAAE,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;AACtE,YAAI,SAAS,EAAE;AACX,mBAAO;AACH,mBAAG,EAAE,OAAO,CAAC,GAAG;AAChB,wBAAQ,EAAE,OAAO,CAAC,QAAQ;AAC1B,qBAAK,EAAE,SAAS;AAChB,yBAAS,EAAE,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC;aAC9E,CAAC;SACL;KACJ,MAAM;AACH,eAAO,CAAC,GAAG,CAAC,+BAA+B,EAAE,SAAS,CAAC,CAAC;KAC3D;;AAED,WAAO,SAAS,CAAC;CACpB,CAAC;;AAEF,IAAI,KAAK,GAAG,EAAE,CAAC;AACf,IAAI,SAAS,EAAE,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,UAAS,GAAG,EAAE,IAAI,EAAE;AAC1D,QAAI,CAAC,IAAI,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC;;AAE3B,QAAI,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO;AACvB,mBAAe,GAAG,eAAe,GAAG,eAAe,GAAG,IAAI,CAAC,IAAI,KAAK,WAAW,CAAC;AAChF,QAAI,CAAC,eAAe,EAAE,OAAO;;AAE7B,eAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;AAEvB,QAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;AACnB,eAAO,GAAG;AACN,eAAG,EAAE,WAAW,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,IAAI;AAC9B,oBAAQ,EAAE,WAAW,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,IAAI;SACtC,CAAA;KACJ,MAAM,IAAI,OAAO,EAAE;AAChB,YAAI,YAAY,GAAG,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC1C,YAAI,YAAY,EAAE;AACd,iBAAK,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;SAC5B;AACD,eAAO,GAAG,SAAS,CAAC;KACvB;;AAED,OAAG,EAAE,CAAC;CACT,CAAC,CAAC;;AAEF,SAAS,QAAQ,CAAC,KAAK,EAAE,KAAK,EAAE;AAC7B,QAAI,CAAC,IAAI,GAAG,IAAI,CAAC;AACjB,QAAI,CAAC,KAAK,GAAG,IAAI,CAAC;AAClB,QAAI,CAAC,OAAO,GAAG,IAAI,CAAC;AACpB,QAAI,CAAC,OAAO,GAAG,IAAI,CAAC;AACpB,QAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACnB,QAAI,CAAC,KAAK,GAAG,KAAK,CAAC;;AAEnB,QAAI,CAAC,IAAI,EAAE,CAAC;CACb;;AAED,QAAQ,CAAC,SAAS,CAAC,IAAI,GAAG,YAAW;AACnC,QAAI,IAAI,GAAG,IAAI,WAAW,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;AACpD,QAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;AACtB,QAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;AACxB,QAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;AAC5B,QAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;CAC7B,CAAC;;AAEF,SAAS,WAAW,CAAC,EAAE,EAAE;AACvB,QAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;AACf,KAAC,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,IAAI,CAAC,CAAC;AAC1B,KAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;AACvB,KAAC,GAAG,CAAC,GAAG,EAAE,CAAC;AACX,KAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;AACvB,KAAC,GAAG,CAAC,GAAG,EAAE,CAAC;AACX,KAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;AACvB,KAAC,GAAG,CAAC,GAAG,EAAE,CAAC;;AAEX,QAAI,CAAC,IAAI,GAAG,CAAC,CAAC;AACd,QAAI,CAAC,KAAK,GAAG,CAAC,CAAC;AACf,QAAI,CAAC,OAAO,GAAG,CAAC,CAAC;AACjB,QAAI,CAAC,OAAO,GAAG,CAAC,CAAC;CAClB,CAAC;;AAEF,IAAI,CAAC,IAAI,GAAG,UAAS,KAAK,EAAE,KAAK,EAAE;AACjC,WAAO,IAAI,QAAQ,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;CACnC,CAAC;;AAEF,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,UAAS,KAAK,EAAE;AACpC,WAAO,IAAI,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;CAClC,CAAC;;AAEJ,IAAI,QAAQ,GAAG,SAAX,QAAQ,CAAY,KAAK,EAAE;AAC7B,QAAI,YAAY,GAAG,CAAC,CAAC;AACrB,SAAK,CAAC,OAAO,CAAC,UAAS,EAAE,EAAC;AACxB,oBAAY,IAAI,EAAE,CAAC,SAAS,CAAA;AAC5B,eAAO,CAAC,GAAG,CAAC,2BAA2B,EAAE,EAAE,CAAC,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,SAAS,GAAG,EAAE,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,SAAS,GAAG,EAAE,CAAC,CAAC,CAAC;KAChH,CAAC,CAAC;;AAEH,QAAI,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,GAAG,EAAE,CAAC,CAAC;AAChD,QAAI,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,GAAG,EAAE,CAAC,CAAC;;AAElD,WAAO,CAAC,GAAG,CAAC,eAAe,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;CAC1D,CAAA","file":"app-compiled.js","sourcesContent":["var argv = require('yargs').argv;\r\nvar PdfReader = require(\"pdfreader\").PdfReader;\r\nvar itemsPriors = [];\r\nvar dayInfo;\r\nvar idx = 0;\r\nvar canStartProcess = false;\r\n\r\nvar sumHours = function(start1, end1, start2, end2) {\r\n    let diff1 = end1.diff(start1);\r\n    let diff2 = end2.diff(start2);\r\n    let minutes = (diff1.hours + diff2.hours) * 60;\r\n    return minutes + diff1.minutes + diff2.minutes;\r\n};\r\n\r\nvar isHour = function(text) {\r\n    return text === \"0013\" || text === \"0001\";\r\n};\r\n\r\nvar convertToDate = function(year, month, day, hours) {\r\n    return hours.map(function(obj){\r\n        return new Date(month + '/' + day + '/' + year + ' ' + obj);\r\n    });\r\n};\r\n\r\nvar extractDays = function(hoursText) {\r\n    hoursText = hoursText.replace('/', '//').trim();\r\n    var hoursExtracted = /(.*)(Horas.*)/gmi.exec(hoursText);\r\n    if (hoursExtracted && hoursExtracted.length > 0) {\r\n        hoursText = hoursExtracted[1].trim();\r\n        hoursList = convertToDate(2015, 1, dayInfo.day, hoursText.split(' '));\r\n        if (hoursText) {\r\n            return {\r\n                day: dayInfo.day,\r\n                dayMonth: dayInfo.dayMonth,\r\n                hours: hoursList,\r\n                totalWork: sumHours(hoursList[0], hoursList[1], hoursList[2], hoursList[3])\r\n            };\r\n        }\r\n    } else {\r\n        console.log(\"Hours not extracted from '%s'\", hoursText);\r\n    }\r\n\r\n    return undefined;\r\n};\r\n\r\nvar hours = [];\r\nnew PdfReader().parseFileItems(argv._[0], function(err, item) {\r\n    if (!item) callback(hours);\r\n\r\n    if (!item.text) return;\r\n    canStartProcess = canStartProcess ? canStartProcess : item.text === \"Marcações\";\r\n    if (!canStartProcess) return;\r\n\r\n    itemsPriors.push(item);\r\n\r\n    if (isHour(item.text)) {\r\n        dayInfo = {\r\n            day: itemsPriors[idx - 2].text,\r\n            dayMonth: itemsPriors[idx - 1].text\r\n        }\r\n    } else if (dayInfo) {\r\n        var extractedDay = extractDays(item.text);\r\n        if (extractedDay) {\r\n            hours.push(extractedDay);\r\n        }\r\n        dayInfo = undefined;\r\n    }\r\n\r\n    idx++;\r\n});\r\n\r\n function DateDiff(date1, date2) {\r\n    this.days = null;\r\n    this.hours = null;\r\n    this.minutes = null;\r\n    this.seconds = null;\r\n    this.date1 = date1;\r\n    this.date2 = date2;\r\n\r\n    this.init();\r\n  }\r\n\r\n  DateDiff.prototype.init = function() {\r\n    var data = new DateMeasure(this.date1 - this.date2);\r\n    this.days = data.days;\r\n    this.hours = data.hours;\r\n    this.minutes = data.minutes;\r\n    this.seconds = data.seconds;\r\n  };\r\n\r\n  function DateMeasure(ms) {\r\n    var d, h, m, s;\r\n    s = Math.floor(ms / 1000);\r\n    m = Math.floor(s / 60);\r\n    s = s % 60;\r\n    h = Math.floor(m / 60);\r\n    m = m % 60;\r\n    d = Math.floor(h / 24);\r\n    h = h % 24;\r\n\r\n    this.days = d;\r\n    this.hours = h;\r\n    this.minutes = m;\r\n    this.seconds = s;\r\n  };\r\n\r\n  Date.diff = function(date1, date2) {\r\n    return new DateDiff(date1, date2);\r\n  };\r\n\r\n  Date.prototype.diff = function(date2) {\r\n    return new DateDiff(this, date2);\r\n  };\r\n\r\nvar callback = function(hours) {\r\n  var totalMinutes = 0;\r\n  hours.forEach(function(it){\r\n    totalMinutes += it.totalWork\r\n    console.log(\"On day %s, you work %s:%s\", it.day, Math.floor(it.totalWork / 60), Math.round(it.totalWork % 60));\r\n  });\r\n\r\n  var hoursWorked = Math.floor(totalMinutes / 60);\r\n  var minutesWorked = Math.round(totalMinutes % 60);\r\n\r\n  console.log(\"Total : %d:%d\", hoursWorked, minutesWorked);\r\n}\r\n"]}